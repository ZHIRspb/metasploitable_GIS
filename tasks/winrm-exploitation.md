# WinRM Exploitation

Windows Remote Management (WinRM) - это реализация WS-Management Protocol, протокола Simple Object Access Protocol (SOAP), основанного на брандмауэре, который позволяет взаимодействовать оборудованию и операционным системам разных производителей.

<figure><img src="../.gitbook/assets/nmap_5985_port.png" alt=""><figcaption></figcaption></figure>

#### Crackmapexec WinRM BruteForce

Для подбора учетных данный мы можете использовать утилиту crackmapexec

<figure><img src="../.gitbook/assets/crackmapexec_1.png" alt=""><figcaption></figcaption></figure>

<figure><img src="../.gitbook/assets/crackmapexec_2.png" alt=""><figcaption></figcaption></figure>

#### Crackmap WinRM Command Execution

С помощью данной утилиты вы также можете выполнять команды на удаленном хосте, используя валидные учетные данные

<figure><img src="../.gitbook/assets/crackmapexec_creds.png" alt=""><figcaption></figcaption></figure>

#### Metasploit WinRM Exploitation

В Metasploit предусмотрен модуль `exploit/winrm/winrm_script_exec` для получения сессии

<figure><img src="../.gitbook/assets/winrm_script_exec.png" alt=""><figcaption></figcaption></figure>
